Sub stocks_final()    Dim ws As Worksheet    For Each ws In Worksheets        ' Set an initial variable for holding the stock, volume, and metrics        Dim stock As String            Dim stockVolume As Double        stockVolume = 0                Dim TickOpen As Double        Dim TickClose As Double        Dim yearlyChange As Double        Dim percentChange As Double                TickOpen = ws.Cells(2, 3).Value                ' Keep track of seperate ticker results in summary table        Dim summaryTableRow As Integer        summaryTableRow = 2                ' Find the last non-blank cell in column1        Dim lastRow As Long        lastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row                ' Loop through all Tickers        For I = 2 To lastRow                    ' Check if we are still within the same ticker, if not then...            If ws.Cells(I + 1, 1).Value <> ws.Cells(I, 1).Value Then                            ' Set the stock name                stock = ws.Cells(I, 1).Value                                ' Add to the Total Volume                stockVolume = stockVolume + ws.Cells(I, 7).Value                                ' Get the close                TickClose = ws.Cells(I, 6).Value                                yearlyChange = TickClose - TickOpen                                ' Finding percent change                If TickOpen > 0 Then                    percentChange = yearlyChange / TickOpen                Else                    percentChange = 0                End If                                ' Print the Credit Card Brand in the Summary Table                ws.Cells(summaryTableRow, 9).Value = stock                                ' Print the Total Volume to the Summary Table                ws.Cells(summaryTableRow, 12).Value = stockVolume                ws.Cells(summaryTableRow, 10).Value = yearlyChange                ws.Cells(summaryTableRow, 11).Value = percentChange                                ' Conditional formatting cell color                If yearlyChange < 0 Then                    ws.Cells(summaryTableRow, 10).Interior.ColorIndex = 3                Else                    ws.Cells(summaryTableRow, 10).Interior.ColorIndex = 4                End If                                                ' RESETS                                ' Add one to the summary table row                summaryTableRow = summaryTableRow + 1                                ' Reset the new Ticker's Values                stockVolume = 0                percentChange = 0                                ' Reset stock open                TickOpen = ws.Cells(I + 1, 3).Value                            ' If the cell immediately following a row is the same ticker...            Else                            ' Add to the Total Volume                stockVolume = stockVolume + ws.Cells(I, 7).Value                            End If                Next I            ' Setting variables to locate and print specific values                Dim MaxValue As Double        Dim MinValue As Double        Dim MaxVolume As Double                Dim MaxRow As Long        Dim MinRow As Long        Dim VolRow As Long                Dim TickMax As String        Dim TickMin As String        Dim TickVol As String                    ' Determining range of wanted values                Rng = ws.Range("K:K")        rng2 = ws.Range("L:L")                ' Locating and printing each value                MaxValue = Application.WorksheetFunction.Max(Rng)        MaxRow = Application.WorksheetFunction.Match(MaxValue, Rng, 0)        TickMax = ws.Cells(MaxRow, 9).Value                MinValue = Application.WorksheetFunction.Min(Rng)        MinRow = Application.WorksheetFunction.Match(MinValue, Rng, 0)        TickMin = ws.Cells(MinRow, 9).Value                MaxVolume = Application.WorksheetFunction.Max(rng2)        VolRow = Application.WorksheetFunction.Match(MaxVolume, rng2, 0)        TickVol = ws.Cells(VolRow, 9).Value                ' Print values of the greatest values in new summary table        ws.Cells(2, 16).Value = MaxValue        ws.Cells(3, 16).Value = MinValue        ws.Cells(4, 16).Value = MaxVolume                ' Print values of ticker with the greatest values in new summary table                ws.Cells(2, 15).Value = TickMax        ws.Cells(3, 15).Value = TickMin        ws.Cells(4, 15).Value = TickVol            ' Style column        ws.Range("K:K").NumberFormat = "0.00%"        ws.Range("P2:P3").NumberFormat = "0.00%"            NextEnd Sub